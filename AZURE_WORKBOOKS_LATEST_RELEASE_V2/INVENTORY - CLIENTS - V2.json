{
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workbookDisplayName": {
      "type": "string",
      "defaultValue": "INVENTORY - CLIENTS - V2",
      "metadata": {
        "description": "The friendly name for the workbook that is used in the Gallery or Saved List.  This name must be unique within a resource group."
      }
    },
    "workbookType": {
      "type": "string",
      "defaultValue": "workbook",
      "metadata": {
        "description": "The gallery that the workbook will been shown under. Supported values include workbook, tsg, etc. Usually, this is 'workbook'"
      }
    },
    "workbookSourceId": {
      "type": "string",
      "defaultValue": "Azure Monitor",
      "metadata": {
        "description": "The id of resource instance to which the workbook will be associated"
      }
    },
    "workbookId": {
      "type": "string",
      "defaultValue": "[newGuid()]",
      "metadata": {
        "description": "The unique guid for this workbook instance"
      }
    }
  },
  "resources": [
    {
      "name": "[parameters('workbookId')]",
      "type": "microsoft.insights/workbooks",
      "location": "[resourceGroup().location]",
      "apiVersion": "2022-04-01",
      "dependsOn": [],
      "kind": "shared",
      "properties": {
        "displayName": "[parameters('workbookDisplayName')]",
        "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"InvClientComputerInfoV2_CL \\r\\n| summarize CollectionTime = arg_max(CollectionTime,*) by Computer\\r\\n| summarize total = count()\",\"size\":0,\"title\":\"DEVICES IN INVENTORY LAST 31 DAYS | CLIENTS | COUNT\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"/subscriptions/fce4f282-fcc6-43fb-94d8-bf1701b862c3/resourceGroups/rg-logworkspaces-client-demo6470D-t/providers/Microsoft.OperationalInsights/workspaces/log-management-client-demo6470D-t\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"total\",\"formatter\":12,\"formatOptions\":{\"min\":0,\"palette\":\"blue\"}},\"showBorder\":true,\"size\":\"auto\"}},\"name\":\"DEVICES IN INVENTORY LAST 31 DAYS | CLIENTS | COUNT\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"InvClientComputerInfoV2_CL \\r\\n| summarize CollectionTime = arg_max(CollectionTime,*) by Computer\\r\\n| extend OsUpTime = todynamic(OsUptime)\\r\\n| mv-expand OsUptime\\r\\n| project Computer, UserLoggedOn, OsUptime_Days=toint(OsUpTime.Days), CollectionTime\\r\\n| sort by OsUptime_Days desc\\r\\n| where OsUptime_Days > 7\\r\\n| summarize total = count()\",\"size\":0,\"title\":\"NO RESTART MORE THAN 7 DAYS DAY | CLIENTS | COUNT\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"/subscriptions/fce4f282-fcc6-43fb-94d8-bf1701b862c3/resourceGroups/rg-logworkspaces-client-demo6470D-t/providers/Microsoft.OperationalInsights/workspaces/log-management-client-demo6470D-t\"],\"visualization\":\"tiles\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"total\",\"formatter\":12,\"formatOptions\":{\"min\":0,\"palette\":\"redBright\"}},\"showBorder\":true,\"size\":\"auto\"}},\"name\":\"NO RESTART MORE THAN 7 DAYS DAY | CLIENTS | COUNT\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"InvClientComputerInfoV2_CL \\r\\n| summarize CollectionTime = arg_max(CollectionTime,*) by Computer\\r\\n| project-reorder CollectionTime desc\\r\\n| project-reorder Computer asc\\r\\n| project Computer, UserLoggedOn, OsArchitecture, OsBuildNumber, OsName, WindowsVersion, CsSystemFamily, CsModel\\r\\n| sort by Computer asc\",\"size\":0,\"showAnalytics\":true,\"title\":\"INVENTORY | CLIENTS | GROUPED OS\",\"noDataMessageStyle\":5,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"/subscriptions/fce4f282-fcc6-43fb-94d8-bf1701b862c3/resourceGroups/rg-logworkspaces-client-demo6470D-t/providers/Microsoft.OperationalInsights/workspaces/log-management-client-demo6470D-t\"],\"gridSettings\":{\"rowLimit\":10000,\"filter\":true,\"hierarchySettings\":{\"treeType\":1,\"groupBy\":[\"WindowsVersion\",\"OsBuildNumber\"],\"expandTopLevel\":true}}},\"name\":\"INVENTORY | CLIENTS | GROUPED OS\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"InvClientComputerInfoV2_CL \\r\\n| summarize CollectionTime = arg_max(CollectionTime,*) by Computer\\r\\n| project-reorder CollectionTime desc\\r\\n| project-reorder Computer asc\\r\\n| project Computer, UserLoggedOn, CollectionTime, CsManufacturer, CsModel, CsName, CsNetworkAdapters, CsNetworkServerModeEnabled, CsNumberOfLogicalProcessors, CsNumberOfProcessors, CsOEMStringArray, CsPartOfDomain, CsPauseAfterReset, CsPCSystemTypeEx, CsPCSystemType, CsPhyicallyInstalledMemory, CsPowerOnPasswordStatus, CsPowerState, CsPowerSupplyState, CsPrimaryOwnerName, CsProcessors, CsResetCapability, CsResetCount, CsResetLimit, CsRoles, CsStatus, CsSystemFamily, CsSystemSKUNumber, CsSystemType, CsThermalState, CsTotalPhysicalMemory, CsUserName, CsWakeUpType, CsAdminPasswordStatus, CsAutomaticManagedPagefile, CsAutomaticResetBootOption, CsAutomaticResetCapability, CsBootROMSupported, CsBootStatus, CsBootupState, CsCaption, CsChassisBootupState, CsChassisSKUNumber, CsCurrentTimeZone, CsDaylightInEffect, CsDescription, CsDNSHostName, CsDomainRole, CsDomain, CsEnableDaylightSavingsTime, CsFrontPanelResetStatus, CsHypervisorPresent, CsInfraredSupported, CsKeyboardPasswordStatus \\r\\n| sort by Computer asc\",\"size\":0,\"showAnalytics\":true,\"title\":\"INVENTORY OVERVIEW (CS)  | CLIENTS | LIST\",\"noDataMessageStyle\":5,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"/subscriptions/fce4f282-fcc6-43fb-94d8-bf1701b862c3/resourceGroups/rg-logworkspaces-client-demo6470D-t/providers/Microsoft.OperationalInsights/workspaces/log-management-client-demo6470D-t\"],\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"INVENTORY OVERVIEW (CS)  | CLIENTS | LIST\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"InvClientComputerInfoV2_CL \\r\\n| summarize CollectionTime = arg_max(CollectionTime,*) by Computer\\r\\n| project-reorder CollectionTime desc\\r\\n| project-reorder Computer asc\\r\\n| project Computer, UserLoggedOn, CollectionTime, BiosBIOSVersion, BiosCaption, BiosCharacteristics, BiosCurrentLanguage, BiosDescription, BiosEmbeddedControllerMajorVersion, BiosEmbeddedControllerMinorVersion, BiosFirmwareType, BiosInstallableLanguages, BiosListOfLanguages, BiosManufacturer, BiosName, BiosPrimaryBIOS, BiosReleaseDate, BiosSerialNumber=BiosSeralNumber, BiosSMBIOSBIOSVersion, BiosSMBIOSMajorVersion, BiosSMBIOSMinorVersion, BiosSMBIOSPresent, BiosSoftwareElementState, BiosStatus, BiosSystemBiosMajorVersion, BiosSystemBiosMinorVersion, BiosTargetOperatingSystem, BiosVersion \\r\\n| sort by Computer asc\",\"size\":0,\"showAnalytics\":true,\"title\":\"INVENTORY OVERVIEW (BIOS)  | CLIENTS | LIST\",\"noDataMessageStyle\":5,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"/subscriptions/fce4f282-fcc6-43fb-94d8-bf1701b862c3/resourceGroups/rg-logworkspaces-client-demo6470D-t/providers/Microsoft.OperationalInsights/workspaces/log-management-client-demo6470D-t\"],\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"INVENTORY OVERVIEW (BIOS)  | CLIENTS | LIST\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"InvClientComputerInfoV2_CL \\r\\n| summarize CollectionTime = arg_max(CollectionTime,*) by Computer\\r\\n| extend OsUpTime = todynamic(OsUptime)\\r\\n| mv-expand OsUptime\\r\\n| project-reorder CollectionTime desc\\r\\n| project-reorder Computer asc\\r\\n| project Computer, UserLoggedOn, CollectionTime, OsArchitecture,OsBootDevice,OsBuildNumber,OsBuildType,OsCodeSet,OsCountryCode,OsCurrentTimeZone,OsDataExecutionPrevention32BitApplications,OsDataExecutionPreventionAvailable,OsDataExecutionPreventionDrivers,OsDataExecutionPreventionSupportPolicy,OsDebug,OsDistributed,OsEncryptionLevel,OsForegroundApplicationBoost,OsFreePhysicalMemory,OsFreeSpaceInPagingFiles,OsFreeVirtualMemory,OsHardwareAbstractionLayer,OsHotFixes,OsInstallDate,OsInUseVirtualMemory,OsLanguage,OsLastBootUpTime,OsLocalDateTime,OsLocaleID,OsLocale,OsManufacturer,OsMaxNumberOfProcesses,OsMaxProcessMemorySize,OsMuiLanguages,OsName,OsNumberOfLicensedUsers,OsNumberOfProcesses,OsNumberOfUsers,OsOperatingSystemSKU,OsPagingFiles,OsPortableOperatingSystem,OsPrimary,OsProductSuites,OsProductType,OsRegisteredUser,OsSerialNumber,OsServicePackMajorVersion,OsServicePackMinorVersion,OsSizeStoredInPagingFiles,OsStatus,OsSuites,OsSystemDevice,OsSystemDirectory,OsSystemDrive,OsTotalVirtualMemorySize,OsTotalVisibleMemorySize,OsType,OsUptime_Days=toint(OsUpTime.Days),OsUptime_Hours=toint(OsUpTime.Hours),OsVersion,OsWindowsDirectory\\r\\n| sort by Computer asc\",\"size\":0,\"showAnalytics\":true,\"title\":\"INVENTORY OVERVIEW (OS)  | CLIENTS | LIST\",\"noDataMessageStyle\":5,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"/subscriptions/fce4f282-fcc6-43fb-94d8-bf1701b862c3/resourceGroups/rg-logworkspaces-client-demo6470D-t/providers/Microsoft.OperationalInsights/workspaces/log-management-client-demo6470D-t\"],\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"INVENTORY OVERVIEW (OS)  | CLIENTS | LIST\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"InvClientComputerInfoV2_CL \\r\\n| summarize CollectionTime = arg_max(CollectionTime,*) by Computer\\r\\n| project-reorder CollectionTime desc\\r\\n| project-reorder Computer asc\\r\\n| project Computer, UserLoggedOn, CollectionTime, OsName, OsVersion, WindowsVersion,WindowsProductName,WindowsProductId,WindowsCurrentVersion,WindowsBuildLabEx,WindowsSystemRoot,WindowsRegisteredOwner,WindowsInstallDateFromRegistry,WindowsInstallationType,WindowsEditionId\\r\\n| sort by Computer asc\",\"size\":0,\"showAnalytics\":true,\"title\":\"INVENTORY OVERVIEW (WINDOWS)  | CLIENTS | LIST\",\"noDataMessageStyle\":5,\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"/subscriptions/fce4f282-fcc6-43fb-94d8-bf1701b862c3/resourceGroups/rg-logworkspaces-client-demo6470D-t/providers/Microsoft.OperationalInsights/workspaces/log-management-client-demo6470D-t\"],\"gridSettings\":{\"rowLimit\":10000,\"filter\":true}},\"name\":\"INVENTORY OVERVIEW (WINDOWS)  | CLIENTS | LIST\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"InvClientComputerInfoV2_CL \\r\\n| summarize CollectionTime = arg_max(CollectionTime,*) by Computer\\r\\n| extend OsUpTime = todynamic(OsUptime)\\r\\n| mv-expand OsUptime\\r\\n| project Computer, UserLoggedOn, OsUptime_Days=toint(OsUpTime.Days), CollectionTime\\r\\n| sort by OsUptime_Days desc\\r\\n| where OsUptime_Days > 7\\r\\n\",\"size\":0,\"showAnalytics\":true,\"title\":\"NO RESTART MORE THAN 7 DAYS DAY | CLIENTS | LIST\",\"showExportToExcel\":true,\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"/subscriptions/fce4f282-fcc6-43fb-94d8-bf1701b862c3/resourceGroups/rg-logworkspaces-client-demo6470D-t/providers/Microsoft.OperationalInsights/workspaces/log-management-client-demo6470D-t\"],\"visualization\":\"table\",\"sortBy\":[],\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"total\",\"formatter\":12,\"formatOptions\":{\"min\":0,\"palette\":\"redBright\"}},\"showBorder\":true,\"size\":\"auto\"}},\"name\":\"NO RESTART MORE THAN 7 DAYS DAY | CLIENTS | LIST\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"InvClientComputerInfoV2_CL \\r\\n| summarize CollectionTime = arg_max(CollectionTime,*) by Computer\\r\\n| where CollectionTime > ago(31d)\\r\\n| extend OsUpTime = todynamic(OsUptime)\\r\\n| mv-expand OsUptime\\r\\n| project Computer, UserLoggedOn, OsUptime_Days=toint(OsUpTime.Days), CollectionTime\\r\\n| sort by OsUptime_Days desc\\r\\n| where OsUptime_Days > 7\\r\\n| summarize total = count() by bin(CollectionTime, 1d)\",\"size\":0,\"aggregation\":3,\"title\":\"NO RESTART MORE THAN 7 DAYS DAY | CLIENTS | TIME 1 MONTH COLLECTION TIME\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"crossComponentResources\":[\"/subscriptions/fce4f282-fcc6-43fb-94d8-bf1701b862c3/resourceGroups/rg-logworkspaces-client-demo6470D-t/providers/Microsoft.OperationalInsights/workspaces/log-management-client-demo6470D-t\"],\"visualization\":\"timechart\",\"tileSettings\":{\"titleContent\":{\"columnMatch\":\"total\",\"formatter\":12,\"formatOptions\":{\"min\":0,\"palette\":\"redBright\"}},\"showBorder\":true,\"size\":\"auto\"},\"chartSettings\":{\"ySettings\":{\"numberFormatSettings\":{\"unit\":0,\"options\":{\"style\":\"decimal\",\"useGrouping\":true,\"minimumFractionDigits\":0,\"maximumFractionDigits\":0}}}}},\"name\":\"NO RESTART MORE THAN 7 DAYS DAY | CLIENTS | TIME 1 MONTH COLLECTION TIME\"}],\"isLocked\":false,\"fallbackResourceIds\":[\"Azure Monitor\"],\"fromTemplateId\":\"ArmTemplates-/subscriptions/fce4f282-fcc6-43fb-94d8-bf1701b862c3/resourceGroups/rg-dashboards-workbooks-demo6470D-t/providers/microsoft.insights/workbooktemplates/INVENTORY - CLIENTS - V2\"}",
        "version": "1.0",
        "sourceId": "[parameters('workbookSourceId')]",
        "category": "[parameters('workbookType')]"
      }
    }
  ],
  "outputs": {
    "workbookId": {
      "type": "string",
      "value": "[resourceId( 'microsoft.insights/workbooks', parameters('workbookId'))]"
    }
  },
  "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"
}